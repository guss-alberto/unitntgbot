x-service-common: &service-common
  build: .
  # image: ghcr.io/guss-alberto/unitntgbot
  restart: unless-stopped

services:
  telegram_bot:
    <<: *service-common
    command: bot
    environment:
      TELEGRAM_BOT_TOKEN: $TELEGRAM_BOT_TOKEN
      DB_PATH: /db/database.sqlite3
      TZ: Europe/Rome

      CANTEEN_SVC_URL: http://canteen_svc:5000
      EXAMS_SVC_URL: http://exams_svc:5000
      LECTURES_SVC_URL: http://lectures_svc:5000
      MAPS_SVC_URL: http://maps_svc:5000
      ROOMS_SVC_URL: http://rooms_svc:5000
      TT_SVC_URL: N/A
    volumes:
      - bot-data:/db:rw

  canteen_svc:
    <<: *service-common
    command: canteen
    environment:
      DB_PATH: /db/database.sqlite3
    volumes:
      - canteen-data:/db:rw

  exams_svc:
    <<: *service-common
    command: exams
    environment:
      DB_PATH: /db/database.sqlite3
    volumes:
      - exams-data:/db:rw

  lectures_svc:
    <<: *service-common
    command: lectures
    environment:
      DB_PATH: /db/database.sqlite3
      EXAMS_SVC_URL: http://exams_svc:5000
    volumes:
      - lectures-data:/db:rw

  # maps_svc:
  #   <<: *service-common
  #   command: maps

  rooms_svc:
    <<: *service-common
    command: rooms

volumes:
  bot-data:
  canteen-data:
  exams-data:
  lectures-data:
